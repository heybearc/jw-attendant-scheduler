(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[140],{9070:function(e,s,a){Promise.resolve().then(a.bind(a,8307))},8307:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return c}});var t=a(7437),n=a(9294),i=a(9376),r=a(2265),l=a(7648);function c(){let{user:e,loading:s}=(0,n.a)(),a=(0,i.useRouter)(),[c,o]=(0,r.useState)({maintenanceMode:!1,allowRegistration:!1,requireEmailVerification:!0,sessionTimeout:480,maxLoginAttempts:5,passwordMinLength:8,enableAuditLogging:!0,autoBackupEnabled:!1,backupRetentionDays:30,systemName:"JW Attendant Scheduler",organizationName:"Congregation",supportEmail:"support@congregation.org",defaultUserRole:"ATTENDANT"}),[d,m]=(0,r.useState)(!0),[u,x]=(0,r.useState)(!1),[g,h]=(0,r.useState)("general");(0,r.useEffect)(()=>{if(!s){if(!e||"ADMIN"!==e.role){a.push("/unauthorized");return}m(!1)}},[e,s,a]);let b=async()=>{x(!0);try{console.log("Saving settings:",c),await new Promise(e=>setTimeout(e,1e3)),alert("Settings saved successfully!")}catch(e){console.error("Failed to save settings:",e),alert("Failed to save settings")}finally{x(!1)}};return s||d?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-lg",children:"Loading..."})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,t.jsx)("div",{className:"container mx-auto px-4 max-w-4xl",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"System Settings"}),(0,t.jsx)(l.default,{href:"/admin",className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600",children:"Back to Admin"})]}),c.maintenanceMode&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded",children:[(0,t.jsx)("h3",{className:"font-semibold text-red-800",children:"\uD83D\uDEA8 Maintenance Mode Active"}),(0,t.jsx)("p",{className:"text-red-700",children:"The system is currently in maintenance mode. Only administrators can access the application."})]}),(0,t.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,t.jsx)("nav",{className:"-mb-px flex space-x-8",children:[{id:"general",name:"General",icon:"⚙️"},{id:"security",name:"Security",icon:"\uD83D\uDD12"},{id:"email",name:"Email & Notifications",icon:"\uD83D\uDCE7"},{id:"backup",name:"Backup & Maintenance",icon:"\uD83D\uDCBE"}].map(e=>(0,t.jsxs)("button",{onClick:()=>h(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm ".concat(g===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.icon," ",e.name]},e.id))})}),"general"===g&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"System Name"}),(0,t.jsx)("input",{type:"text",value:c.systemName,onChange:e=>o({...c,systemName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Organization Name"}),(0,t.jsx)("input",{type:"text",value:c.organizationName,onChange:e=>o({...c,organizationName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Support Email"}),(0,t.jsx)("input",{type:"email",value:c.supportEmail,onChange:e=>o({...c,supportEmail:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default User Role"}),(0,t.jsxs)("select",{value:c.defaultUserRole,onChange:e=>o({...c,defaultUserRole:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,t.jsx)("option",{value:"ATTENDANT",children:"Attendant"}),(0,t.jsx)("option",{value:"KEYMAN",children:"Keyman"}),(0,t.jsx)("option",{value:"ASSISTANT_OVERSEER",children:"Assistant Overseer"}),(0,t.jsx)("option",{value:"OVERSEER",children:"Overseer"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:c.allowRegistration,onChange:e=>o({...c,allowRegistration:e.target.checked}),className:"mr-3"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Allow user self-registration"})]}),(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:c.requireEmailVerification,onChange:e=>o({...c,requireEmailVerification:e.target.checked}),className:"mr-3"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Require email verification for new accounts"})]})]})]}),"security"===g&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Session Timeout (minutes)"}),(0,t.jsx)("input",{type:"number",value:c.sessionTimeout,onChange:e=>o({...c,sessionTimeout:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"30",max:"1440"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"30 minutes to 24 hours"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Login Attempts"}),(0,t.jsx)("input",{type:"number",value:c.maxLoginAttempts,onChange:e=>o({...c,maxLoginAttempts:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"3",max:"10"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"3 to 10 attempts before lockout"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Minimum Password Length"}),(0,t.jsx)("input",{type:"number",value:c.passwordMinLength,onChange:e=>o({...c,passwordMinLength:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"6",max:"20"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"6 to 20 characters"})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:c.enableAuditLogging,onChange:e=>o({...c,enableAuditLogging:e.target.checked}),className:"mr-3"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Enable audit logging"})]})})]}),"email"===g&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded",children:[(0,t.jsx)("h3",{className:"font-semibold text-blue-800",children:"Email Configuration"}),(0,t.jsx)("p",{className:"text-blue-700 text-sm",children:"Email settings are managed in the Email Configuration module."}),(0,t.jsx)(l.default,{href:"/admin/email-config",className:"inline-block mt-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 text-sm",children:"Configure Email Settings"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Notification Preferences (Coming Soon)"}),(0,t.jsxs)("div",{className:"text-gray-500",children:[(0,t.jsx)("p",{children:"Future notification settings will include:"}),(0,t.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,t.jsx)("li",{children:"Assignment reminder emails"}),(0,t.jsx)("li",{children:"Event notification preferences"}),(0,t.jsx)("li",{children:"System maintenance alerts"}),(0,t.jsx)("li",{children:"User activity notifications"})]})]})]})]}),"backup"===g&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 rounded p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-red-800",children:"Maintenance Mode"}),(0,t.jsx)("p",{className:"text-red-700 text-sm",children:c.maintenanceMode?"System is currently in maintenance mode":"System is available to all users"})]}),(0,t.jsx)("button",{onClick:()=>{c.maintenanceMode?o({...c,maintenanceMode:!1}):confirm("Enable maintenance mode? This will prevent all users except admins from accessing the system.")&&o({...c,maintenanceMode:!0})},className:"px-4 py-2 rounded text-sm font-medium ".concat(c.maintenanceMode?"bg-green-600 text-white hover:bg-green-700":"bg-red-600 text-white hover:bg-red-700"),children:c.maintenanceMode?"Disable Maintenance":"Enable Maintenance"})]})}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Backup Retention (days)"}),(0,t.jsx)("input",{type:"number",value:c.backupRetentionDays,onChange:e=>o({...c,backupRetentionDays:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"7",max:"365"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"7 to 365 days"})]})}),(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",checked:c.autoBackupEnabled,onChange:e=>o({...c,autoBackupEnabled:e.target.checked}),className:"mr-3"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Enable automatic backups"})]})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"System Actions (Coming Soon)"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsx)("button",{disabled:!0,className:"bg-gray-300 text-gray-500 px-4 py-2 rounded cursor-not-allowed",children:"Create Manual Backup"}),(0,t.jsx)("button",{disabled:!0,className:"bg-gray-300 text-gray-500 px-4 py-2 rounded cursor-not-allowed",children:"Clear System Cache"}),(0,t.jsx)("button",{disabled:!0,className:"bg-gray-300 text-gray-500 px-4 py-2 rounded cursor-not-allowed",children:"Export System Data"}),(0,t.jsx)("button",{disabled:!0,className:"bg-gray-300 text-gray-500 px-4 py-2 rounded cursor-not-allowed",children:"View System Logs"})]})]})]}),(0,t.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"Changes will take effect immediately after saving."}),(0,t.jsx)("button",{onClick:b,disabled:u,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:u?"Saving...":"Save Settings"})]})})]})})})}},9294:function(e,s,a){"use strict";a.d(s,{Providers:function(){return l},a:function(){return r}});var t=a(7437),n=a(2265);let i=(0,n.createContext)(void 0);function r(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function l(e){let{children:s}=e,[a,r]=(0,n.useState)(null),[l,c]=(0,n.useState)(!0);(0,n.useEffect)(()=>{o()},[]);let o=async()=>{try{let e=await fetch("/api/auth/me",{credentials:"include"});if(e.ok){let s=await e.json();r(s.user)}}catch(e){console.error("Auth check failed:",e)}finally{c(!1)}},d=async(e,s)=>{try{let a=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e,password:s})});if(a.ok){let e=await a.json();return r(e.user),!0}return!1}catch(e){return console.error("Login failed:",e),!1}},m=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),r(null)}catch(e){console.error("Logout failed:",e)}};return(0,t.jsx)(i.Provider,{value:{user:a,loading:l,login:d,logout:m},children:s})}},9376:function(e,s,a){"use strict";var t=a(5475);a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})}},function(e){e.O(0,[981,971,117,744],function(){return e(e.s=9070)}),_N_E=e.O()}]);