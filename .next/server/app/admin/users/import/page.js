(()=>{var e={};e.id=4913,e.ids=[4913],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1206:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>d}),s(8845),s(4752),s(5866);var r=s(3191),a=s(8716),l=s(7922),n=s.n(l),i=s(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["admin",{children:["users",{children:["import",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,8845)),"/Users/cory/Documents/Cloudy-Work/applications/jw-attendant-scheduler/app/admin/users/import/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,4752)),"/Users/cory/Documents/Cloudy-Work/applications/jw-attendant-scheduler/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/cory/Documents/Cloudy-Work/applications/jw-attendant-scheduler/app/admin/users/import/page.tsx"],m="/admin/users/import/page",u={require:s,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/users/import/page",pathname:"/admin/users/import",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7163:(e,t,s)=>{Promise.resolve().then(s.bind(s,7322))},1907:(e,t,s)=>{Promise.resolve().then(s.bind(s,8143))},3040:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},7322:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(326),a=s(8143),l=s(5047),n=s(7577),i=s(434);function o(){let{user:e,loading:t}=(0,a.a)();(0,l.useRouter)();let[s,o]=(0,n.useState)(null),[d,c]=(0,n.useState)(!1),[m,u]=(0,n.useState)(null),[x,p]=(0,n.useState)(!1),h=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?p(!0):"dragleave"===e.type&&p(!1)},b=async()=>{try{let e=await fetch("/api/admin/users/import");if(e.ok){let t=await e.blob(),s=window.URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="user_import_template.csv",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(s),document.body.removeChild(r)}}catch(e){console.error("Failed to download template:",e),alert("Failed to download template")}},g=async()=>{if(!s){alert("Please select a file to import");return}c(!0);try{let e=new FormData;e.append("file",s);let t=await fetch("/api/admin/users/import",{method:"POST",body:e}),r=await t.json();u(r),r.success&&alert(`Successfully imported ${r.successCount} users!`)}catch(e){console.error("Failed to import users:",e),alert("Failed to import users")}finally{c(!1)}},j=()=>{o(null),u(null)};return t?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"text-lg",children:"Loading..."})}):r.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:r.jsx("div",{className:"container mx-auto px-4 max-w-4xl",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold",children:"Import Users"}),r.jsx(i.default,{href:"/admin",className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600",children:"Back to Admin"})]}),!m&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded",children:[r.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Before You Start"}),(0,r.jsxs)("ol",{className:"text-sm text-blue-700 space-y-1",children:[r.jsx("li",{children:"1. Download the CSV template below"}),r.jsx("li",{children:"2. Fill in your user data following the template format"}),r.jsx("li",{children:"3. Required fields: firstName, lastName, email, role"}),r.jsx("li",{children:"4. Valid roles: ADMIN, OVERSEER, ASSISTANT_OVERSEER, KEYMAN, ATTENDANT"}),r.jsx("li",{children:"5. Upload your completed CSV file"})]})]}),r.jsx("div",{className:"mb-6",children:r.jsx("button",{onClick:b,className:"bg-green-600 text-white px-6 py-2 rounded hover:bg-green-700 flex items-center",children:"\uD83D\uDCE5 Download CSV Template"})}),(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload CSV File"}),(0,r.jsxs)("div",{className:`border-2 border-dashed rounded-lg p-8 text-center ${x?"border-blue-400 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:h,onDragLeave:h,onDragOver:h,onDrop:e=>{if(e.preventDefault(),e.stopPropagation(),p(!1),e.dataTransfer.files&&e.dataTransfer.files[0]){let t=e.dataTransfer.files[0];t.name.endsWith(".csv")?(o(t),u(null)):alert("Please select a CSV file")}},children:[r.jsx("input",{type:"file",accept:".csv",onChange:e=>{if(e.target.files&&e.target.files[0]){let t=e.target.files[0];t.name.endsWith(".csv")?(o(t),u(null)):alert("Please select a CSV file")}},className:"hidden",id:"file-upload"}),r.jsx("label",{htmlFor:"file-upload",className:"cursor-pointer",children:(0,r.jsxs)("div",{className:"text-gray-600",children:[r.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:r.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),r.jsx("p",{className:"mt-2 text-lg",children:s?s.name:"Drag and drop your CSV file here, or click to select"}),r.jsx("p",{className:"text-sm text-gray-500",children:"CSV files only"})]})})]})]}),s&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded",children:[r.jsx("h3",{className:"font-semibold text-green-800",children:"File Selected"}),(0,r.jsxs)("p",{className:"text-green-700",children:[s.name," (",(s.size/1024).toFixed(1)," KB)"]})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("button",{onClick:j,className:"bg-gray-300 text-gray-700 px-6 py-2 rounded hover:bg-gray-400",disabled:!s,children:"Clear"}),r.jsx("button",{onClick:g,disabled:!s||d,className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:d?"Importing...":"Import Users"})]})]}),m&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:`p-4 rounded border ${m.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[(0,r.jsxs)("h3",{className:`font-semibold ${m.success?"text-green-800":"text-red-800"}`,children:["Import ",m.success?"Successful":"Failed"]}),r.jsx("p",{className:m.success?"text-green-700":"text-red-700",children:m.success?`Successfully imported ${m.successCount} users and sent invitation emails.`:`Found ${m.errorCount} errors in ${m.totalRows} rows.`})]}),m.success&&m.createdUsers.length>0&&(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-semibold text-gray-800 mb-4",children:"Imported Users"}),r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full table-auto border border-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-left border-b",children:"Name"}),r.jsx("th",{className:"px-4 py-2 text-left border-b",children:"Email"}),r.jsx("th",{className:"px-4 py-2 text-left border-b",children:"Role"}),r.jsx("th",{className:"px-4 py-2 text-left border-b",children:"Invitation"})]})}),r.jsx("tbody",{children:m.createdUsers.map((e,t)=>(0,r.jsxs)("tr",{className:"border-b",children:[(0,r.jsxs)("td",{className:"px-4 py-2",children:[e.firstName," ",e.lastName]}),r.jsx("td",{className:"px-4 py-2",children:e.email}),r.jsx("td",{className:"px-4 py-2",children:r.jsx("span",{className:"px-2 py-1 rounded text-xs bg-blue-100 text-blue-800",children:e.role})}),r.jsx("td",{className:"px-4 py-2",children:r.jsx("span",{className:`px-2 py-1 rounded text-xs ${e.emailSent?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:e.emailSent?"Sent":"Failed"})})]},t))})]})})]}),!m.success&&m.errors.length>0&&(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-semibold text-red-800 mb-4",children:"Validation Errors"}),r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full table-auto border border-red-200",children:[r.jsx("thead",{className:"bg-red-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-4 py-2 text-left border-b",children:"Row"}),r.jsx("th",{className:"px-4 py-2 text-left border-b",children:"Field"}),r.jsx("th",{className:"px-4 py-2 text-left border-b",children:"Error"}),r.jsx("th",{className:"px-4 py-2 text-left border-b",children:"Value"})]})}),r.jsx("tbody",{children:m.errors.map((e,t)=>(0,r.jsxs)("tr",{className:"border-b",children:[r.jsx("td",{className:"px-4 py-2",children:e.row}),r.jsx("td",{className:"px-4 py-2 font-mono text-sm",children:e.field}),r.jsx("td",{className:"px-4 py-2 text-red-700",children:e.message}),r.jsx("td",{className:"px-4 py-2 font-mono text-sm bg-gray-100",children:e.value||"(empty)"})]},t))})]})})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("button",{onClick:j,className:"bg-gray-500 text-white px-6 py-2 rounded hover:bg-gray-600",children:"Import Another File"}),r.jsx(i.default,{href:"/admin",className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",children:"Back to Admin Dashboard"})]})]})]})})})}},8143:(e,t,s)=>{"use strict";s.d(t,{Providers:()=>i,a:()=>n});var r=s(326),a=s(7577);let l=(0,a.createContext)(void 0);function n(){let e=(0,a.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function i({children:e}){let[t,s]=(0,a.useState)(null),[n,i]=(0,a.useState)(!0),o=async(e,t)=>{try{let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e,password:t})});if(r.ok){let e=await r.json();return s(e.user),!0}return!1}catch(e){return console.error("Login failed:",e),!1}},d=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),s(null)}catch(e){console.error("Logout failed:",e)}};return r.jsx(l.Provider,{value:{user:t,loading:n,login:o,logout:d},children:e})}},5047:(e,t,s)=>{"use strict";var r=s(7389);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},8845:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(8570).createProxy)(String.raw`/Users/cory/Documents/Cloudy-Work/applications/jw-attendant-scheduler/app/admin/users/import/page.tsx#default`)},4752:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d,metadata:()=>o});var r=s(9510),a=s(5384),l=s.n(a);s(1159),s(7272);var n=s(8570);(0,n.createProxy)(String.raw`/Users/cory/Documents/Cloudy-Work/applications/jw-attendant-scheduler/app/providers.tsx#useAuth`);let i=(0,n.createProxy)(String.raw`/Users/cory/Documents/Cloudy-Work/applications/jw-attendant-scheduler/app/providers.tsx#Providers`),o={title:"JW Attendant Scheduler",description:"Next.js SDD Implementation of JW Attendant Scheduler"};function d({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{className:l().className,children:r.jsx(i,{children:e})})})}},7272:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[9276,2892,434],()=>s(1206));module.exports=r})();