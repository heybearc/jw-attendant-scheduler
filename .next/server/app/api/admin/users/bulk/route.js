"use strict";(()=>{var e={};e.id=1434,e.ids=[1434],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6003:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>c,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>p});var a={};t.r(a),t.d(a,{POST:()=>l});var s=t(9303),o=t(8716),i=t(670),n=t(7070);let u=new(t(3524)).PrismaClient;async function l(e){try{let{action:r,userIds:t,data:a}=await e.json();if(!r||!t||!Array.isArray(t)||0===t.length)return n.NextResponse.json({error:"Action and user IDs required"},{status:400});let s=[],o=[];switch(r){case"activate":for(let e of t)try{let r=await u.users.update({where:{id:e},data:{isActive:!0,updatedAt:new Date},select:{id:!0,email:!0,firstName:!0,lastName:!0,isActive:!0}});s.push(r)}catch(r){o.push({userId:e,error:r instanceof Error?r.message:"Unknown error"})}break;case"deactivate":for(let e of t)try{let r=await u.users.update({where:{id:e},data:{isActive:!1,updatedAt:new Date},select:{id:!0,email:!0,firstName:!0,lastName:!0,isActive:!0}});s.push(r)}catch(r){o.push({userId:e,error:r instanceof Error?r.message:"Unknown error"})}break;case"change_role":if(!a?.role)return n.NextResponse.json({error:"Role required for role change action"},{status:400});if(!["ADMIN","OVERSEER","ASSISTANT_OVERSEER","KEYMAN","ATTENDANT"].includes(a.role))return n.NextResponse.json({error:"Invalid role"},{status:400});for(let e of t)try{let r=await u.users.update({where:{id:e},data:{role:a.role,updatedAt:new Date},select:{id:!0,email:!0,firstName:!0,lastName:!0,role:!0}});s.push(r)}catch(r){o.push({userId:e,error:r instanceof Error?r.message:"Unknown error"})}break;case"delete":for(let e of t)try{let r=await u.users.update({where:{id:e},data:{isActive:!1,updatedAt:new Date},select:{id:!0,email:!0,firstName:!0,lastName:!0,isActive:!0}});s.push(r)}catch(r){o.push({userId:e,error:r instanceof Error?r.message:"Unknown error"})}break;default:return n.NextResponse.json({error:"Invalid action"},{status:400})}return n.NextResponse.json({message:`Bulk ${r} completed. ${s.length} successful, ${o.length} failed.`,successful:s,failed:o})}catch(e){return console.error("Failed to perform bulk operation:",e),n.NextResponse.json({error:"Failed to perform bulk operation"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/users/bulk/route",pathname:"/api/admin/users/bulk",filename:"route",bundlePath:"app/api/admin/users/bulk/route"},resolvedPagePath:"/Users/cory/Documents/Cloudy-Work/applications/jw-attendant-scheduler/app/api/admin/users/bulk/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:p,serverHooks:m}=d,f="/api/admin/users/bulk/route";function h(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:p})}}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[9276,5972],()=>t(6003));module.exports=a})();