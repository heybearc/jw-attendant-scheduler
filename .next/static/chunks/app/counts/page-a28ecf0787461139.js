(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{4424:function(e,t,s){Promise.resolve().then(s.bind(s,9199))},9199:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return r}});var a=s(7437),n=s(2265);function r(){let[e,t]=(0,n.useState)([]),[s,r]=(0,n.useState)(!0),[l,o]=(0,n.useState)(""),[i,c]=(0,n.useState)(!1),[d,m]=(0,n.useState)([]),[x,h]=(0,n.useState)(null),[u,p]=(0,n.useState)({eventId:"",sessionName:"",countTime:"",notes:""});(0,n.useEffect)(()=>{g(),v(),b()},[]);let g=async()=>{try{let e=await fetch("/api/counts"),s=await e.json();t(s)}catch(e){console.error("Failed to load count sessions:",e)}finally{r(!1)}},v=async()=>{try{let e=await fetch("/api/events"),t=await e.json();m(t)}catch(e){console.error("Failed to load events:",e)}},b=async()=>{try{let e=await fetch("/api/counts/analytics"),t=await e.json();h(t)}catch(e){console.error("Failed to load analytics:",e)}},j=async()=>{if(!l.trim()){g();return}try{let e=await fetch("/api/counts/search?q=".concat(encodeURIComponent(l))),s=await e.json();t(s)}catch(e){console.error("Search failed:",e)}},N=async e=>{e.preventDefault();try{let e=await fetch("/api/counts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...u,eventId:parseInt(u.eventId),countTime:new Date(u.countTime).toISOString()})});if(e.ok)p({eventId:"",sessionName:"",countTime:"",notes:""}),c(!1),g(),b();else{let t=await e.json();alert(t.error||"Failed to create count session")}}catch(e){console.error("Failed to create count session:",e),alert("Failed to create count session")}},y=async()=>{if(!u.eventId){alert("Please select an event first");return}try{let e=await fetch("/api/counts/generate-name?eventId=".concat(u.eventId)),t=await e.json();p({...u,sessionName:t.sessionName})}catch(e){console.error("Failed to generate session name:",e)}},f=e=>new Date(e).toLocaleString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return s?(0,a.jsx)("div",{className:"container mx-auto p-8",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-300 rounded w-1/4 mb-6"}),(0,a.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,a.jsx)("div",{className:"h-24 bg-gray-200 rounded"},e))})]})}):(0,a.jsxs)("div",{className:"container mx-auto p-8",children:[(0,a.jsx)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 p-4 mb-6",children:(0,a.jsxs)("p",{className:"text-yellow-700",children:[(0,a.jsx)("strong",{children:"Next.js Staging Environment"})," - Count tracking with SDD architecture"]})}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Count Tracking"}),(0,a.jsx)("button",{onClick:()=>c(!0),className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700",children:"Add Count Session"})]}),x&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Total Sessions"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:x.totalSessions})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Active Sessions"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-600",children:x.activeSessions})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Avg per Event"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:x.averageSessionsPerEvent})]}),(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow border",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-500",children:"Most Active Event"}),(0,a.jsx)("p",{className:"text-sm font-bold text-purple-600",children:x.mostActiveEvent?x.mostActiveEvent.eventName:"None"}),x.mostActiveEvent&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[x.mostActiveEvent.sessionCount," sessions"]})]})]}),(0,a.jsxs)("div",{className:"mb-6 flex gap-4",children:[(0,a.jsx)("input",{type:"text",placeholder:"Search count sessions...",value:l,onChange:e=>o(e.target.value),className:"flex-1 px-4 py-2 border rounded-lg",onKeyPress:e=>"Enter"===e.key&&j()}),(0,a.jsx)("button",{onClick:j,className:"bg-gray-600 text-white px-6 py-2 rounded hover:bg-gray-700",children:"Search"}),(0,a.jsx)("button",{onClick:()=>{o(""),g()},className:"bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500",children:"Clear"})]}),i&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg w-96 max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Add Count Session"}),(0,a.jsxs)("form",{onSubmit:N,children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Event"}),(0,a.jsxs)("select",{required:!0,value:u.eventId,onChange:e=>p({...u,eventId:e.target.value}),className:"w-full px-3 py-2 border rounded",children:[(0,a.jsx)("option",{value:"",children:"Select an event"}),d.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," - ",new Date(e.date).toLocaleDateString()]},e.id))]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Session Name"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",required:!0,value:u.sessionName,onChange:e=>p({...u,sessionName:e.target.value}),className:"flex-1 px-3 py-2 border rounded",placeholder:"e.g., Morning Session"}),(0,a.jsx)("button",{type:"button",onClick:y,className:"bg-blue-500 text-white px-3 py-2 rounded text-sm hover:bg-blue-600",children:"Auto"})]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Count Time"}),(0,a.jsx)("input",{type:"datetime-local",required:!0,value:u.countTime,onChange:e=>p({...u,countTime:e.target.value}),className:"w-full px-3 py-2 border rounded"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Notes"}),(0,a.jsx)("textarea",{value:u.notes,onChange:e=>p({...u,notes:e.target.value}),className:"w-full px-3 py-2 border rounded h-20",placeholder:"Optional notes about this count session..."})]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("button",{type:"submit",className:"flex-1 bg-purple-600 text-white py-2 rounded hover:bg-purple-700",children:"Create Session"}),(0,a.jsx)("button",{type:"button",onClick:()=>c(!1),className:"flex-1 bg-gray-400 text-white py-2 rounded hover:bg-gray-500",children:"Cancel"})]})]})]})}),(0,a.jsx)("div",{className:"grid gap-4",children:0===e.length?(0,a.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,a.jsx)("p",{className:"text-xl mb-2",children:"No count sessions found"}),(0,a.jsx)("p",{children:"Add your first count session to get started"})]}):e.map(e=>(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow border hover:shadow-lg transition-shadow",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.sessionName}),(0,a.jsxs)("div",{className:"flex items-center text-gray-600 mb-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e.event.name]}),(0,a.jsxs)("div",{className:"flex items-center text-gray-600 mb-2",children:[(0,a.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),f(e.countTime.toString())]}),e.event.location&&(0,a.jsxs)("div",{className:"flex items-center text-gray-600 mb-2",children:[(0,a.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.event.location]}),e.notes&&(0,a.jsx)("p",{className:"text-gray-700 mt-3 italic",children:e.notes})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 ml-4",children:[(0,a.jsx)("span",{className:"px-2 py-1 rounded text-sm ".concat(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"Active":"Inactive"}),(0,a.jsx)("button",{className:"bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700",children:"View Report"})]})]}),(0,a.jsxs)("div",{className:"border-t pt-3 mt-4 text-sm text-gray-500",children:[(0,a.jsxs)("p",{children:["Created: ",new Date(e.createdAt).toLocaleDateString()]}),(0,a.jsxs)("p",{children:["Event Date: ",new Date(e.event.date).toLocaleDateString()]})]})]},e.id))}),(0,a.jsxs)("div",{className:"mt-8 text-center text-gray-500",children:[(0,a.jsxs)("p",{children:["Total Count Sessions: ",e.length]}),(0,a.jsx)("p",{className:"text-sm",children:"Using SDD Count Tracking Library"})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=4424)}),_N_E=e.O()}]);